# ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ScaffAIãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
tests/
â”œâ”€â”€ e2e/              # E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
â”‚   â””â”€â”€ auth.spec.ts  # èªè¨¼ãƒ•ãƒ­ãƒ¼ã®E2Eãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ unit/             # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰
â”‚   â””â”€â”€ auth.test.tsx # AuthContextã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ setup.ts          # Vitestã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ README.md         # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆã®ç¨®é¡

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰

**ç›®çš„**: å€‹åˆ¥ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„é–¢æ•°ã®å‹•ä½œã‚’æ¤œè¨¼

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**:
- Vitest: é«˜é€Ÿãªãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼
- React Testing Library: Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ
- happy-dom: ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

**å®Ÿè¡Œæ–¹æ³•**:
```bash
# å…¨ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm run test

# UIãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
npm run test:ui

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆä»˜ãã§å®Ÿè¡Œ
npm run test:coverage
```

**ãƒ†ã‚¹ãƒˆå¯¾è±¡**:
- `tests/unit/auth.test.tsx`: AuthContextã®æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
  - AuthProviderã®åˆæœŸåŒ–
  - signIn, signUp, signOuté–¢æ•°ã®å‹•ä½œ
  - èªè¨¼çŠ¶æ…‹ã®å¤‰æ›´ãƒªã‚¹ãƒŠãƒ¼

### E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å®Ÿéš›ã®æ“ä½œãƒ•ãƒ­ãƒ¼ã‚’æ¤œè¨¼

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**:
- Playwright: ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶E2Eãƒ†ã‚¹ãƒˆ
- å¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶: Chrome, Firefox, Safari

**å®Ÿè¡Œæ–¹æ³•**:
```bash
# å…¨E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆé–‹ç™ºã‚µãƒ¼ãƒãƒ¼è‡ªå‹•èµ·å‹•ï¼‰
npm run test:e2e

# UIãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ã€æ¨å¥¨ï¼‰
npm run test:e2e:ui

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:e2e:debug
```

**ãƒ†ã‚¹ãƒˆå¯¾è±¡**:
- `tests/e2e/auth.spec.ts`: èªè¨¼ãƒ•ãƒ­ãƒ¼ã®E2Eãƒ†ã‚¹ãƒˆ
  - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®è¡¨ç¤ºç¢ºèª
  - ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ/å¤±æ•—ãƒ•ãƒ­ãƒ¼
  - ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®è¡¨ç¤º
  - æ–°è¦ç™»éŒ²ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯
  - ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ•ãƒ­ãƒ¼
  - èªè¨¼ãªã—ã§ã®ä¿è­·ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹
  - ãƒ¢ãƒã‚¤ãƒ«ç”»é¢ã§ã®å‹•ä½œç¢ºèª

## ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœ

### ç¾åœ¨ã®çŠ¶æ…‹ï¼ˆ2025-10-23ï¼‰

**ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: âœ… **7/7 passed**
- AuthProviderã®åˆæœŸåŒ–
- useAuthãƒ•ãƒƒã‚¯ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- signInæˆåŠŸ/å¤±æ•—
- signUpæˆåŠŸ
- signOutæˆåŠŸ
- èªè¨¼çŠ¶æ…‹å¤‰æ›´ã®ãƒªã‚¹ãƒŠãƒ¼

**E2Eãƒ†ã‚¹ãƒˆ**: âœ… **21/27 passed, 6 skipped**
- Chrome, Firefox, Safariã®3ãƒ–ãƒ©ã‚¦ã‚¶ã§21ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹
- 6ãƒ†ã‚¹ãƒˆã¯Supabaseå®Ÿèªè¨¼ãŒå¿…è¦ãªãŸã‚ã‚¹ã‚­ãƒƒãƒ—

### ã‚¹ã‚­ãƒƒãƒ—ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆ

ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã¯ã€å®Ÿéš›ã®Supabaseèªè¨¼ç’°å¢ƒãŒå¿…è¦ãªãŸã‚ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¦ã„ã¾ã™ï¼š
- ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸãƒ•ãƒ­ãƒ¼ï¼ˆå®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ï¼‰
- ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ•ãƒ­ãƒ¼ï¼ˆãƒ­ã‚°ã‚¤ãƒ³å¾Œã®çŠ¶æ…‹ãŒå¿…è¦ï¼‰

**å®Ÿè¡Œæ–¹æ³•**:
```typescript
// tests/e2e/auth.spec.ts ã§ test.skip ã‚’ test ã«å¤‰æ›´
test('æ­£ã—ã„èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ', async ({ page }) => {
  // ãƒ†ã‚¹ãƒˆå®Ÿè£…...
})
```

## ğŸš€ ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

### æ¨å¥¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

1. **é–‹ç™ºä¸­**: UIãƒ¢ãƒ¼ãƒ‰ã§å³åº§ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
   ```bash
   npm run test:ui
   ```

2. **ã‚³ãƒŸãƒƒãƒˆå‰**: å…¨ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
   ```bash
   npm run test && npm run test:e2e
   ```

3. **ãƒ‡ãƒãƒƒã‚°**: ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚’ãƒ‡ãƒãƒƒã‚°
   ```bash
   npm run test:e2e:debug
   ```

## ğŸ”§ ãƒ†ã‚¹ãƒˆè¨­å®š

### Vitestè¨­å®šï¼ˆvitest.config.tsï¼‰

```typescript
{
  environment: 'happy-dom',          // ãƒ–ãƒ©ã‚¦ã‚¶ç’°å¢ƒã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
  globals: true,                     // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ãƒ†ã‚¹ãƒˆé–¢æ•°ã‚’ä½¿ç”¨å¯èƒ½
  setupFiles: ['./tests/setup.ts'],  // ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«
  include: ['tests/unit/**/*.test.{ts,tsx}'],
  exclude: ['node_modules', 'tests/e2e/**']
}
```

### Playwrightè¨­å®šï¼ˆplaywright.config.tsï¼‰

```typescript
{
  testDir: './tests/e2e',     // E2Eãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
  use: {
    baseURL: 'http://localhost:3000',
    trace: 'on-first-retry',  // å¤±æ•—æ™‚ã®ãƒˆãƒ¬ãƒ¼ã‚¹è¨˜éŒ²
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  },
  webServer: {
    command: 'npm run dev',   // è‡ªå‹•ã§ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
    url: 'http://localhost:3000',
    reuseExistingServer: true
  }
}
```

## ğŸ“ ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ä¾‹

```typescript
import { describe, it, expect, vi } from 'vitest'
import { render, screen } from '@testing-library/react'

describe('ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå', () => {
  it('æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã‚’èª¬æ˜', () => {
    render(<Component />)
    expect(screen.getByText('ãƒ†ã‚­ã‚¹ãƒˆ')).toBeInTheDocument()
  })
})
```

### E2Eãƒ†ã‚¹ãƒˆã®ä¾‹

```typescript
import { test, expect } from '@playwright/test'

test('ãƒ†ã‚¹ãƒˆã®èª¬æ˜', async ({ page }) => {
  await page.goto('/login')
  await page.getByPlaceholder('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹').fill('test@example.com')
  await page.getByRole('button', { name: /ãƒ­ã‚°ã‚¤ãƒ³/ }).click()
  await expect(page).toHaveURL('/dashboard')
})
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

```bash
# node_modulesã‚’å‰Šé™¤ã—ã¦å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules package-lock.json
npm install

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
npm run test -- --clearCache
```

### E2Eãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹

```bash
# Playwrightãƒ–ãƒ©ã‚¦ã‚¶ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npx playwright install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
npm run dev
```

### ãƒ¢ãƒƒã‚¯ãŒæ©Ÿèƒ½ã—ãªã„

```typescript
// Vitestã®ãƒ¢ãƒƒã‚¯ã¯è‡ªå‹•çš„ã«ãƒ›ã‚¤ã‚¹ãƒˆã•ã‚Œã‚‹
vi.mock('@/lib/supabase', () => ({
  supabase: {
    auth: {
      // ãƒ¢ãƒƒã‚¯å®Ÿè£…...
    }
  }
}))
```

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Vitestå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vitest.dev/)
- [Playwrightå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://playwright.dev/)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
- [Testing Best Practices](https://kentcdodds.com/blog/common-mistakes-with-react-testing-library)

## âœ… TASK-107å®Œäº†

ã“ã®ãƒ†ã‚¹ãƒˆç’°å¢ƒã¯ã€TASK-107ã€Œèªè¨¼ãƒ•ãƒ­ãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆã€ã®æˆæœç‰©ã§ã™ã€‚

**å®Œäº†æ¡ä»¶**:
- âœ… E2Eãƒ†ã‚¹ãƒˆä½œæˆï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ•ãƒ­ãƒ¼ï¼‰ - `tests/e2e/auth.spec.ts`
- âœ… ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆèªè¨¼é–¢æ•°ï¼‰ - `tests/unit/auth.test.tsx`
- âœ… å…¨ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ - 7/7 ãƒ¦ãƒ‹ãƒƒãƒˆã€21/27 E2Eï¼ˆ6ã‚¹ã‚­ãƒƒãƒ—ï¼‰
- âœ… èªè¨¼ãƒ•ãƒ­ãƒ¼ã«å•é¡Œãªã—

**ä»Šå¾Œã®æ‹¡å¼µ**:
- Supabase Testç’°å¢ƒã®æ§‹ç¯‰
- ä»–ã®æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã€ä½œå›³æ©Ÿèƒ½ãªã©ï¼‰
- CI/CDçµ±åˆï¼ˆGitHub Actionsï¼‰
